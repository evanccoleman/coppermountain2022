\documentclass{beamer}

\mode<presentation>
\setbeamerfont{footnote}{size=\tiny}
\setbeamertemplate{navigation symbols}{}

\usetheme{Warsaw}

\usepackage[backend=bibtex,style=verbose]{biblatex}
\usepackage{graphicx}

\usepackage{tikz}
\usetikzlibrary{backgrounds,positioning,fit}
\usepackage{adjustbox}

\usepackage[linesnumbered,lined,noline,ruled,noend]{algorithm2e}
\usepackage{subfig}
\usepackage{pgfplots}

\AtBeginSection[]
{
	\begin{frame}
		\frametitle{Outline}
		\tableofcontents[currentsection]
	\end{frame}
}

\bibliography{./bibs/Asynchronous-Applications,./bibs/Asynchronous-FT,./bibs/Asynchronous-Theoretical,./bibs/Example-Problems,./bibs/Fault-Tolerance,./bibs/Fixed-Point,./bibs/General-HPC,./bibs/HPC-Math-Software,./bibs/Iterative-Methods,./bibs/Preconditioning,./bibs/Self-Citations,./bibs/Textbooks}

\title[Randomized Asynchronous Linear Solvers]{Dynamic Non-Uniform Randomization in Asynchronous Linear Solvers}
\author[Coleman \& Sosonkina]{Evan Coleman and Masha Sosonkina}

\date{}

\begin{document}

%------------------------------------------------------------------------------
% Front matter
%
\begin{frame}
	\titlepage
\end{frame}


\begin{frame}
	\frametitle{Outline}
	\tableofcontents
\end{frame}

\section{Motivation}

\begin{frame}
	\frametitle{Introduction}
	\begin{itemize}
		\item Problem: solve the linear system $Ax = b$
		\item Some systems don't need to be solved exactly
		    \begin{itemize}
		        \item e.g., there may be applications where quickly arriving at a sufficiently good answer is preferable to getting an exact answer in a longer period of time
		    \end{itemize}
	    \item There are a number of papers that explore the feasibility of using randomized linear solvers to achieve this goal:
	        \begin{itemize}
	            \item \textcite{leventhal2010randomized}
	            \item \textcite{griebel2012greedy}
	            \item \textcite{avron2015revisiting}
	        \end{itemize}
	\end{itemize}	
\end{frame}

\begin{frame}
	\frametitle{Motivation}
	\begin{itemize}
		\item \textcite{wolfson2017distributed} investigated using a Southwell-like approach towards solving linear systems
	\end{itemize}	
	\begin{block}{Question:}
	    Is there someway to combine the natural greediness of the Southwell algorithm with the randomized asynchronous nature of the solvers on the previous slide?
	\end{block}
\end{frame}


\section{Ideas for Improvement}

\begin{frame}
	\frametitle{Setting the stage}
	\begin{itemize}
		\item These solvers have applications inside of other solvers, but we're going to focus on their ability to solve systems directly
		\item In the next section, we'll discuss some blocking strategies and show some results for different ideas, but this section will be focused more on examining individual elements (rather than blocks of elements)
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{``New'' approach}
	\begin{itemize}
		\item Make the random selection change dynamically 
		\item Goal is to gain some benefit of selecting the ``right'' blocks (similar to classical Southwell) without adding so much computational overhead that the total execution time is slower
		\item Based around monitoring which blocks contribute most to the residual $r = b - Ax$
		\item Periodically find and rank the local/component residuals (for the contribution of block $i$):
			\begin{equation}
				r_i = b_i - Ax_i
			\end{equation}
			and make the selection using a non-uniform distribution that favors selection of components with higher local residual
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Approaches towards making the component selection}
	\begin{itemize}
		\item Previous approaches:
		    \begin{itemize}
		        \item Uniform distribution
		        \item Discrete (non-updated) distribution defined by the ratio of the diagonal element to the trace
		            \begin{equation}
		                \mathbb{P}(i=k) = \frac{a_{kk}}{tr(A)}
		            \end{equation}
		        \item ``Greedy'' selection\footcite{griebel2012greedy} picks an element within a parameter defined threshold of optimal in the Southwell sense 
		    \end{itemize}
	\end{itemize}
\end{frame}


\begin{frame}
	\frametitle{Approaches towards making the component selection}
	\begin{itemize}
		\item Possible new approaches:
		    \begin{itemize}
		        \item Discrete distribution defined by the ratio of the local residual to the sum of all residuals
		            \begin{equation}
		                \mathbb{P}(i=k) = \frac{r_{k}}{\sum_j r_j}
		            \end{equation}
		        \item Periodically fitting a continuous distribution to the (sorted) local residuals and drawing random numbers from this distribution
		    \end{itemize}
	\end{itemize}
\end{frame}


\begin{frame}
	\frametitle{Questions to investigate}
	\begin{itemize}
		\item Can the potential benefit from this greedier selection really outweigh the extra computational overhead of generating a more optimal selection?
		\item Does this extend naturally to block variants?
		\item This style of approach introduces a reasonably large set of parameters that may be up to the user to tune appropriately to the problem at hand- is there someway to optimize the parameter selection based on intrinsic properties of the matrix?
		    \begin{itemize}
		        \item e.g., how dynamically the distributions are updated, when to use a continuous vs discrete distribution
		    \end{itemize}
	    \item How do we communicate solver wide information about the dynamic distribution without breaking the asynchronous nature of the solver?
	        \begin{itemize}
	            \item Is this different in shared vs distributed memory?
	        \end{itemize}
	\end{itemize}
\end{frame}

\section{Numerical Results}

\begin{frame}
	\frametitle{More motivation}
	\begin{itemize}
		\item One of the first questions should be: how different are the local contributions to the residual?
		\item For matrices where the local residuals, $r_i$, are similar, any Southwell-like weighting will not show much improvement over a uniform random distribution
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Residual data for finite-difference of 2D Laplacian}
	\begin{figure}[H]
		\centering
		\subfloat[Unsorted residuals]{\includegraphics[width=0.50\textwidth]{images/init_resids_10x10.pdf}}
		\subfloat[Sorted residuals]{\includegraphics[width=0.50\textwidth]{images/init_resids_10x10_sorted.pdf}}
		\caption{Initial component residuals ($r_i / \max (r_i)$).}
		\label{fig:initial-residuals-laplacian}
	\end{figure}
\end{frame}

% TODO: Add a triangular distribution?
% TODO: Show the distribution at several iteration counts?
% TODO: Find a way to show the comparison with which components would be selected discrete local residual distribution vs discrete diagonal element distribution
\begin{frame}
	\frametitle{Ranked residual data for finite-difference of 2D Laplacian}
	\begin{figure}[H]
		\centering
		\subfloat[Sorted Residuals, exponential distributions]{\includegraphics[width=0.75\textwidth]{images/exp_dist_overlay_init.pdf}}
	\end{figure}
\end{frame}

\begin{frame}
	\frametitle{Solver data (Laplacian)}
	\begin{figure}[H]
		\centering
		\subfloat[2D problem (5-pt stencil, $10\times 10$ grid)]{\includegraphics[width=0.45\textwidth]{images/res_10x10.pdf}}
		\subfloat[3D problem (27-pt stencil, $10 \times 10 \times 10$ grid)]{\includegraphics[width=0.45\textwidth]{images/res_3D_10x10x10.pdf}}
		\caption{Residual ($r / r_0$) progression for the first 10,000 iterations of four stationary methods solving the 2D (a) and 3D (b) Laplacian.}
	\end{figure}
\end{frame}

% TODO: Find data (MATLAB or other) showing residual progression of solver methods on another problem
\begin{frame}
	\frametitle{Solver data (???)}
	\begin{itemize}
	    \item TODO 1
	\end{itemize}
\end{frame}

% TODO: Find data  showing residual progression of solver methods at scale
\begin{frame}
	\frametitle{Solver data (???)}
	\begin{itemize}
	    \item TODO 2
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Approach: block methods}
	\begin{itemize}
	    \item One of the next logical steps would be to look into the extension of these ideas to block methods
		\item Divide the domain into $m$ subdomains, $\mathbb{R}^n = \mathbb{R}^{n_1} \times \mathbb{R}^{n_2} \times \cdots \mathbb{R}^{n_m}$, where $n = \sum_i n_i$
		\item Each time a block is selected it performs one or more internal iterations of a stationary solver
	\end{itemize}
\end{frame}

\begin{frame}[shrink]
	\frametitle{Notional block picture}
	\begin{figure}[H]
		\scalebox{1.0}{
			\begin{tikzpicture}
			\draw[step=5mm,gray,very thin] (0,0) grid (7.5,7.5);
			
			\draw[step=5mm,gray,very thin] (0,0) grid (7.5,7.5);
			\draw[step=5mm,gray,very thin] (0,-3.5) grid (7.5,-1);
			
			\draw[step=5mm,gray,very thin] (8.49999,-3.5) grid (10,-1);
			\draw[step=5mm,gray,very thin] (8.49999,0) grid (10,7.5);
			
			\fill[yellow!50!black,opacity=0.3]   (0,-3.5) rectangle (7.5,-1);
			\fill[yellow!50!black,opacity=0.3]   (8.49999,-3.5) rectangle (10,-1);
			
			\fill[green!50!black,opacity=0.3] (0,7.5) rectangle (7.5,5);
			\fill[green!50!black,opacity=0.3] (8.49999,7.5) rectangle (10,5);
			
			\fill[blue!50!black,opacity=0.3]  (0,5) rectangle (7.5,2.5);
			\fill[blue!50!black,opacity=0.3]  (8.49999,5) rectangle (10,2.5);
			
			\fill[red!50!black,opacity=0.3]   (0,2.5) rectangle (7.5,0);
			\fill[red!50!black,opacity=0.3]   (8.49999,2.5) rectangle (10,0);
			
			\node at (8, -2.25) {\bf \Large $\cdots$};
			\node at (8, 1.25) {\bf \Large $\cdots$};
			\node at (8, 3.75) {\bf \Large $\cdots$};
			\node at (8, 6.25) {\bf \Large $\cdots$};
			
			\node at (1.25, -0.5) {\bf $\vdots$};
			\node at (3.75, -0.5) {\bf $\vdots$};
			\node at (6.25, -0.5) {\bf $\vdots$};
			\node at (9.25, -0.5) {\bf $\vdots$};
			
			\node at (8, -0.5) {\bf \large $\ddots$};
			
			\node at (1.25, -0.5) {\bf $\vdots$};
			\node at (3.75, -0.5) {\bf $\vdots$};
			\node at (6.25, -0.5) {\bf $\vdots$};
			
			\node at (3.75, -2.25) {\Huge \bf $B_{m}$};
			\node at (3.75, 1.25) {\Huge \bf $B_3$};
			\node at (3.75, 3.75) {\Huge \bf $B_2$};
			\node at (3.75, 6.25) {\Huge \bf $B_1$};
			
			\draw[black] (0,7.5) rectangle (10,-3.5);
			\end{tikzpicture}
		}
	\end{figure}
\end{frame}

\begin{frame}
	\frametitle{Generic block algorithm}
	\begin{algorithm}[H]
		\DontPrintSemicolon
		\For {each processing element $P_{l}$} {
			\For {$i = 1, 2, \ldots$ until convergence} {
				Pick a block $j \in \{1, 2, \ldots, m\}$ {\em{\underline{somehow}}} \; 
				Read the corresponding entries of $A, x, b$ \;
				Perform Jacobi or Gauss-Seidel relaxations for all equations in block $j$ \;
				Update the data for block $j$ \;
			}
		}
	\end{algorithm}
	\begin{itemize}
		\item The way that each processor selects the block it works on can alter convergence
		\item Before going into block selection strategies, first a brief aside regarding synchronous and asynchronous updates
	\end{itemize}
\end{frame}

% TODO: Find data  showing residual progression of block solver methods
\begin{frame}
	\frametitle{Solver data (???)}
	\begin{itemize}
	    \item TODO 2
	\end{itemize}
\end{frame}




\section{Summary \& Path Forward}

\begin{frame}
	\frametitle{Summary}
	\begin{itemize}
		\item Dynamic non-uniform randomization provides a potential way to improve the performance of asynchronous linear solvers
		\item Moving forward, many questions need to be answered to establish that it's an area worth pursuing
		\item Initial results do suggest that there is potential for the method to provide a modest improvement over existing techniques in certain circumstances
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Moving forward}
	\begin{itemize}
		\item Work on proving convergence as a per iteration reduction in the expected error
		\item Look into dealing with the distributed memory environment
		\item Try incorporating new solvers into more complex existing routines
		\item Keep experimenting with different distributions (still chosen beforehand) and ranking methods and periodicities
		\item Try using an evolving probability distribution where the parameters of distribution shift over time
		\item Investigating the impact that different problems have
		\item Look into possible transfer of ideas to problems in convex optimization
	\end{itemize}
\end{frame}
 
\begin{frame}
	\frametitle{}
	\begin{center}
	    Questions? 
	\end{center}
    
\end{frame}





\end{document}